"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){function e(i){if(o[i])return o[i].exports;var n=o[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var o={};e.m=t,e.c=o,e.i=function(t){return t},e.d=function(t,o,i){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=13)}([function(t,e){function o(){}function i(t,e,o){var i=t._eventable_registry;return e in i?i[e]:o?i[e]=[]:null}o.prototype._initEventable=function(){this._eventable_registry={}},o.prototype.on=function(t,e,o){return i(this,t,!0).push({handler:e,ctx:o}),this},o.prototype.off=function(t,e,o){var n=i(this,t);if(n)for(var r=0,s=n.length;r!==s;r++)if(n[r].handler===e&&n[r].ctx===o)return n.splice(r,1),this;return this},o.prototype.trigger=function(t,e){var o=i(this,t);if(o)for(var n=o.slice(),r=0,s=n.length;r!==s;r++)n[r].handler.call(n[r].ctx,e);return this},t.exports=o},function(t,e){function o(t,e){for(var o in e.prototype)t.prototype[o]=e.prototype[o];return t}t.exports=o},function(t,e,o){function i(){this._initEventable(),this.filter="all"}o(1)(i,o(0)),i.prototype.onChange=function(t,e){this.on("filterChanged",function(o){t.call(e,{filter:o})})},i.prototype.setFilter=function(t){return this.filter=t,this.trigger("filterChanged",t),this},i.prototype.getFilter=function(){return this.filter};var n=new i;t.exports=n},function(t,e,o){function i(t){this._initEventable(),this._root=t,this._input=t.querySelector(".js-todo-add_input"),this._selectAllBtnWrapper=t.querySelector(".todo-add_select-all"),this._selectAllBtn=t.querySelector(".js-todo-add_select-all"),this._input.addEventListener("keypress",this),this._selectAllBtnWrapper.addEventListener("keypress",this),this._selectAllBtn.addEventListener("click",this)}o(1)(i,o(0)),i.prototype._onSelectAll=function(){return this.trigger("selectAll")},i.prototype._onTodoAdd=function(){var t=this._input.value.trim();if(0!==t.length)return this._input.value="",this._input.blur(),this.trigger("todoCreate",{text:t})},i.prototype.getRoot=function(){return this._root},i.prototype.handleEvent=function(t){switch(t.type){case"click":this._onSelectAll();break;case"keypress":13===t.keyCode&&(t.target.closest(".js-todo-add_input")?this._onTodoAdd():t.target.closest(".todo-add_select-all")&&this._onSelectAll())}},t.exports=i},function(t,e){function o(t){this._root=t,this._todosMain=t.querySelector(".js-todos-main")}o.prototype.updateInterfaceVisibility=function(t){return t?this._todosMain.classList.remove("__empty"):this._todosMain.classList.add("__empty"),this},o.prototype.getRoot=function(){return this._root},t.exports=o},function(t,e,o){function i(t){this._initEventable(),this._root=t,this._counter=t.querySelector(".js-left-counter"),this._clearCompletedBtn=t.querySelector(".js-todos-actions-bar_clear-completed"),this._filters=new s(t.querySelector(".js-todos-actions-bar_filters")),this._filters.on("filterSelect",this._onFilterSelected,this),this._clearCompletedBtn.addEventListener("click",this)}var n=o(1),r=o(0),s=o(14);n(i,r),i.prototype._onFilterSelected=function(t){return this.trigger("filterSelected",t)},i.prototype._onClearCompleted=function(){return this.trigger("clearCompleted")},i.prototype.setLeftTodosCount=function(t){return this._counter.innerHTML=t+"&nbsp;"+(1===t?"item":"items")+"&nbsp;left",this},i.prototype.manageClearCompletedVisibility=function(t){return t?this._clearCompletedBtn.classList.remove("__hide"):this._clearCompletedBtn.classList.add("__hide"),this},i.prototype.handleEvent=function(t){switch(t.type){case"click":this._onClearCompleted()}},t.exports=i},function(t,e,o){function i(t){this._initEventable(),this._root=t,this._items=[],this._left=0}var n=o(1),r=o(0),s=o(15),a=o(2);n(i,r),i.prototype.getTodosCount=function(){return this._items.length},i.prototype.addTodo=function(t){var e=new s(t);return this._items.push(e),e.on("todoChange",this._onTodoChange,this).render(this._root),this.filterShowedItems(),this},i.prototype.clearCompleted=function(){for(var t=0,e=this._items.length;t!==e;t++)this._items[t]._model.get("isReady")&&this._items[t].remove();return this},i.prototype._getItemById=function(t){for(var e=0,o=this._items.length;e!==o;e++)if(this._items[e]._model.get("id")===t)return this._items[e];return null},i.prototype._onTodoChange=function(){return this.filterShowedItems(a.getFilter()),this},i.prototype.remove=function(t){var e=this._getItemById(t.get("id"));if(e){e.off("todoChange",this._onTodoChange,this),e.remove();var o=this._items.indexOf(e);this._items.splice(o,1)}return this},i.prototype.selectAll=function(){return this._items.forEach(function(t){t.changeReady(!0)}),this},i.prototype.filterShowedItems=function(t){return t||(t=a.getFilter()),this._items.forEach(function(e){switch(t){case"all":e.visible(!0);break;case"completed":e.visible(e._model.get("isReady"));break;case"active":e.visible(!e._model.get("isReady"))}}),this},i.prototype.getRoot=function(){return this._root},t.exports=i},function(t,e,o){function i(){this._initEventable(),this._items_models=[],this._left=0}var n=o(11),r=o(1),s=o(0),a=o(17),d=new a,l=o(16);r(i,s),i.prototype.updateList=function(){var t=d.getEntriesList();if(t){for(var e=0,o=t.length;e<o;e++)this.add(t[e],!0);for(var i=0,n=this._items_models.length;i<n;i++)this._items_models[i].get("isReady")&&(this._items_models[i].set("isReady",!1),this._items_models[i].set("isReady",!0))}else{for(var r=[],s=void 0,a=0,l=this._items_models.length;a<l;a++)s=this._items_models[a],r.push({id:s.get("id"),isReady:s.get("isReady"),text:s.get("text")});d.putEntriesList(r)}},i.prototype.getList=function(){return this._items_models},i.prototype.getLeftTodosCount=function(){return this._left},i.prototype.onChange=function(t,e){return this.on("todoAdd",t).on("todoRemoved",t).on("todoChange",t).on("modelReadyChange",function(o){switch(o.get("isReady")){case!0:0!==this._left&&(this._left-=1);break;case!1:this._left+=1}this.trigger("todoChange"),t.call(e)},this).on("modelRemove",function(o){this.remove(o.get("id")),this.trigger("todoChange"),t.call(e)},this).on("modelChange",function(){this.trigger("todoChange"),t.call(e)},this),this},i.prototype.add=function(t,e){var o=void 0;return o=new l(t.id?t:Object.assign({id:n()},t)),o.onAnyChange(function(t){switch(t.field){case"text":this.trigger("modelTextChange",o);break;case"isReady":this.trigger("modelReadyChange",o);break;case"deleted":this.trigger("modelRemove",o);break;default:this.trigger("modelChange",o)}d.changeListItem({id:o.get("id"),isReady:o.get("isReady"),text:o.get("text")})},this),this._items_models.push(o),!1===o.get("isReady")&&(this._left+=1),e||d.addListItem({id:o.get("id"),isReady:o.get("isReady"),text:o.get("text")}),this.trigger("todoAdd",o),this},i.prototype._getModelById=function(t){for(var e=0,o=this._items_models.length;e!==o;e++)if(this._items_models[e].get("id")===t)return this._items_models[e];return null},i.prototype.remove=function(t){var e=this._getModelById(t);if(e){e.get("isReady")||(this._left-=1),this.trigger("todoRemove",e),e.off("modelFieldChange",this);var o=this.getList().indexOf(e);this.getList().splice(o,1),d.removeListItem(t),this.trigger("todoRemoved")}return this},i.prototype.clearCompleted=function(){return this.getList().slice().forEach(function(t){t.get("isReady")&&this.remove(t.get("id"))},this),this},t.exports=i},function(t,e){var o={},i=window.navigator.userAgent.toLowerCase(),n=function(t){return-1!==i.indexOf(t)};o.ios=function(){return o.iphone()||o.ipod()||o.ipad()},o.iphone=function(){return!o.windows()&&n("iphone")},o.ipod=function(){return n("ipod")},o.ipad=function(){return n("ipad")},o.android=function(){return!o.windows()&&n("android")},o.androidPhone=function(){return o.android()&&n("mobile")},o.androidTablet=function(){return o.android()&&!n("mobile")},o.blackberry=function(){return n("blackberry")||n("bb10")||n("rim")},o.blackberryPhone=function(){return o.blackberry()&&!n("tablet")},o.blackberryTablet=function(){return o.blackberry()&&n("tablet")},o.windows=function(){return n("windows")},o.windowsPhone=function(){return o.windows()&&n("phone")},o.windowsTablet=function(){return o.windows()&&n("touch")&&!o.windowsPhone()},o.fxos=function(){return(n("(mobile;")||n("(tablet;"))&&n("; rv:")},o.fxosPhone=function(){return o.fxos()&&n("mobile")},o.fxosTablet=function(){return o.fxos()&&n("tablet")},o.meego=function(){return n("meego")},o.cordova=function(){return window.cordova&&"file:"===location.protocol},o.nodeWebkit=function(){return"object"===_typeof(window.process)},o.mobile=function(){return o.androidPhone()||o.iphone()||o.ipod()||o.windowsPhone()||o.blackberryPhone()||o.fxosPhone()||o.meego()},o.tablet=function(){return o.ipad()||o.androidTablet()||o.blackberryTablet()||o.windowsTablet()||o.fxosTablet()},o.desktop=function(){return!o.tablet()&&!o.mobile()},t.exports=o},function(t,e){function o(t,e){var o=e||0,n=i;return n[t[o++]]+n[t[o++]]+n[t[o++]]+n[t[o++]]+"-"+n[t[o++]]+n[t[o++]]+"-"+n[t[o++]]+n[t[o++]]+"-"+n[t[o++]]+n[t[o++]]+"-"+n[t[o++]]+n[t[o++]]+n[t[o++]]+n[t[o++]]+n[t[o++]]+n[t[o++]]}for(var i=[],n=0;n<256;++n)i[n]=(n+256).toString(16).substr(1);t.exports=o},function(t,e,o){(function(e){var o,i=e.crypto||e.msCrypto;if(i&&i.getRandomValues){var n=new Uint8Array(16);o=function(){return i.getRandomValues(n),n}}if(!o){var r=new Array(16);o=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),r[e]=t>>>((3&e)<<3)&255;return r}}t.exports=o}).call(e,o(12))},function(t,e,o){function i(t,e,o){var i=e&&o||0;"string"==typeof t&&(e="binary"==t?new Array(16):null,t=null),t=t||{};var s=t.random||(t.rng||n)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e)for(var a=0;a<16;++a)e[i+a]=s[a];return e||r(s)}var n=o(10),r=o(9);t.exports=i},function(t,e){var o;o=function(){return this}();try{o=o||Function("return this")()||(0,eval)("this")}catch(t){"object"===("undefined"==typeof window?"undefined":_typeof(window))&&(o=window)}t.exports=o},function(t,e,o){function i(){s.desktop()&&(document.body.className="hover");var t=new a,e=document.querySelector(".main-wrapper"),o=new d(e),i=new l(e.querySelector(".todo-add")),n=new c(e.querySelector(".js-todos-list")),r=new h(e.querySelector(".todos-actions-bar"));u.onChange(function(t){n.filterShowedItems(t.filter)}),t.onChange(function(){0!==t.getList().length?o.updateInterfaceVisibility(!0):o.updateInterfaceVisibility(!1);var e=t.getLeftTodosCount();r.setLeftTodosCount(e),t.getList().length-e>0?r.manageClearCompletedVisibility(!0):r.manageClearCompletedVisibility(!1)}),i.on("todoCreate",function(e){t.add(e)}).on("selectAll",function(){t.getList().forEach(function(t){t.set("isReady",!0)})}),t.on("todoAdd",function(t){n.addTodo(t)}).on("todoRemove",function(t){n.remove(t)}).on("todoChange",function(){n.filterShowedItems()}),r.on("clearCompleted",function(){t.clearCompleted()}).on("filterSelected",function(t){u.setFilter(t)}),t.updateList()}function n(t){9===t.keyCode&&(document.body.classList.add("user-is-tabbing"),window.removeEventListener("keydown",n),window.addEventListener("mousedown",r))}function r(){document.body.classList.remove("user-is-tabbing"),window.removeEventListener("mousedown",r),window.addEventListener("keydown",n)}var s=o(8),a=o(7),d=o(4),l=o(3),c=o(6),h=o(5),u=o(2);window.addEventListener("DOMContentLoaded",i),window.addEventListener("keydown",n)},function(t,e,o){function i(t){this._initEventable(),this._filters=t.querySelectorAll(".filter"),this._activeFilter=null;for(var e=0,o=this._filters.length;e<o;e++)this._filters[e].addEventListener("click",this),this._filters[e].classList.contains("__active")&&(this._activeFilter=this._filters[e])}o(1)(i,o(0)),i.prototype._onSetFilter=function(t){return this._activeFilter!==t&&(this._activeFilter.classList.remove("__active"),t.classList.add("__active"),this._activeFilter=t,this.trigger("filterSelect",t.dataset.filter)),this},i.prototype.handleEvent=function(t){switch(t.type){case"click":this._onSetFilter(t.target)}},t.exports=i},function(t,e,o){function i(t){this._initEventable();var e=s.todoItem({text:t.get("text")});this._root=e.root,this._readyMarkWrapper=e.readyMarkWrapper,this._readyMark=e.readyMark,this._removeWrapper=e.removeWrapper,this._remove=e.remove,this._text=e.text,this._model=t,this._model.onChange("isReady",function(t){this._manageReadyModificator(t.value)},this),this._readyMarkWrapper.addEventListener("keypress",this),this._readyMark.addEventListener("change",this),this._removeWrapper.addEventListener("keypress",this),this._remove.addEventListener("click",this),this._text.addEventListener("blur",this)}var n=o(1),r=o(0),s=o(19);n(i,r),i.prototype.render=function(t){return t.appendChild(this._root),this},i.prototype._onSetText=function(t){return this._model.get("text")!==t&&(this._text.innerText=t,this._model.set("text",t)),this},i.prototype._manageReadyModificator=function(t){return t?this._root.classList.add("__ready"):this._root.classList.remove("__ready"),this._readyMark.checked=t,this},i.prototype.changeReady=function(t){return t!==this._model.get("isReady")&&(this._model.set("isReady",t),this._manageReadyModificator(t),this.trigger("todoChange",this._model)),this},i.prototype._onRemove=function(){this._model.set("deleted",!0)},i.prototype.remove=function(){return this._root.parentNode.removeChild(this._root),this},i.prototype.visible=function(t){return t?this._root.classList.remove("__hide"):this._root.classList.add("__hide"),this},i.prototype.handleEvent=function(t){switch(t.type){case"change":this.changeReady(this._readyMark.checked);break;case"click":t.target===this._remove&&this._onRemove();break;case"blur":this._onSetText(this._text.innerText);break;case"keypress":13===t.keyCode&&(t.target.closest(".todo-item_ready-mark")?(this._readyMark.checked=!this._readyMark.checked,this.changeReady(this._readyMark.checked)):t.target.closest(".todo-item_remove")&&t.target===this._removeWrapper&&this._onRemove())}},t.exports=i},function(t,e,o){function i(t){this._initEventable(),this._model={id:t.id,isReady:t.isReady||!1,text:t.text}}o(1)(i,o(0)),i.prototype.set=function(t,e){return this._model[t]=e,this.trigger("modelFieldChange",{field:t,value:e}),this},i.prototype.get=function(t){return this._model[t]},i.prototype.onChange=function(t,e,o){return this.on("modelFieldChange",function(i){i.field===t&&e.call(o,i)},this),this},i.prototype.onAnyChange=function(t,e){return this.on("modelFieldChange",function(o){t.call(e,o),this.trigger("modelChange",this)},this),this},t.exports=i},function(t,e,o){function i(){}o(18);i.prototype.getEntriesList=function(){if(void 0!==i){var t=localStorage.getItem("key");if(t)return JSON.parse(t).data}return null},i.prototype.putEntriesList=function(t){if(void 0!==i){var e={time:(new Date).getTime(),data:t};return localStorage.setItem("key",JSON.stringify(e)),!0}return!1},i.prototype.addListItem=function(t){if(void 0!==i){var e=JSON.parse(localStorage.getItem("key"));return e.time=(new Date).getTime(),e.data.push(t),localStorage.setItem("key",JSON.stringify(e)),!0}return!1},i.prototype.removeListItem=function(t){if(void 0!==i){for(var e=JSON.parse(localStorage.getItem("key")),o=0,n=e.data.length;o<n;o++)if(e.data[o].id===t){e.data.splice(o,1);break}return localStorage.setItem("key",JSON.stringify(e)),!0}return!1},i.prototype.changeListItem=function(t){if(void 0!==i){for(var e=JSON.parse(localStorage.getItem("key")),o=0,n=e.data.length;o<n;o++)if(e.data[o].id===t.id){e.data[o]=t;break}return localStorage.setItem("key",JSON.stringify(e)),!0}return!1},t.exports=i},function(t,e){var o=function(){function t(t){}return{getList:t}}();t.exports=o},function(t,e){function o(t){var e=document.getElementById(t);i.innerHTML=e.innerHTML;var o=i.children[0];return i.removeChild(o),o}var i=document.createElement("div"),n={todoItem:function(t){var e=o("todoItemTemplate"),i=e.querySelector(".todo-item_ready-mark"),n=e.querySelector(".js-todo-item_ready-mark"),r=e.querySelector(".todo-item_remove"),s=e.querySelector(".js-todo-item_remove"),a=e.querySelector(".js-todo-item_text");return t.text&&(a.innerText=t.text),t.isReady&&(n.checked=!0),{root:e,text:a,readyMarkWrapper:i,readyMark:n,removeWrapper:r,remove:s}}};t.exports=n}]);